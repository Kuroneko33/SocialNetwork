@using Web.Models
@model List<MessagesViewModel>
@{
    ViewBag.Title = "Мои сообщения";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<table>
    @{
        int userId = 0;
        try
        {
            userId = (int)Membership.GetUser().ProviderUserKey;
        }
        catch (Exception)
        {
        }
    }
    <tr>
        <td>От кого</td>
        <td>Когда</td>
        <td>Текст</td>
    </tr>
    @foreach (MessagesViewModel message in Model)
    {
        if (message.CreatedDate == new DateTime(2020, 8, 18))
        {
            continue;
        }
        <tr>
            <td>@message.UserFrom.LastName @message.UserFrom.FirstName</td>
            <td>@TimeZoneInfo.ConvertTimeFromUtc(message.CreatedDate, TimeZoneInfo.Local)</td>
            <td>@message.Text</td>
        </tr>
    }
</table>
@using (Html.BeginForm("NewMessage", "Messages", FormMethod.Post, new { @class = "form-horizontal" }))
{
    <p>
        Введите текст сообщения:
        <br />
        @Html.HiddenFor(x => x[0].UserFromId)
        @Html.HiddenFor(x => x[0].UserToId)
        @Html.HiddenFor(x => x[0].CreatedDate)
        @Html.TextAreaFor(x => x[0].Text)
        @Html.ValidationMessageFor(x => x[0].Text)
    </p>
    <input type="submit" value="Отправить" />
}